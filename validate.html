<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AuraFlow - Validation Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            background: #0a0a0a;
            color: #ffffff;
        }
        h1 {
            color: #4c9aff;
        }
        .test {
            background: #1f1f1f;
            border: 1px solid #2a2a2a;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        .pass {
            border-left: 4px solid #00c853;
        }
        .fail {
            border-left: 4px solid #ff3366;
        }
        .status {
            font-weight: bold;
            font-size: 1.2em;
        }
        .pass .status { color: #00c853; }
        .fail .status { color: #ff3366; }
        button {
            background: #4c9aff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 20px 0;
        }
        button:hover {
            background: #5aa7ff;
        }
        #summary {
            background: #151515;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .warning {
            background: rgba(255, 171, 0, 0.1);
            border: 1px solid #ffab00;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>üß™ AuraFlow Validation Test</h1>
    <p>This page runs automated validation tests to ensure the application is working correctly.</p>

    <button onclick="runTests()">Run Validation Tests</button>

    <div id="summary"></div>
    <div id="results"></div>

    <div class="warning">
        <strong>‚ö†Ô∏è Note:</strong> This validation page tests the application logic, but the full app should be tested by opening <code>index.html</code> in a browser.
    </div>

    <h2>Manual Verification Steps</h2>
    <ol>
        <li>Open <code>index.html</code> in your browser</li>
        <li>Verify loading screen appears and transitions to app</li>
        <li>Check that 18 events display in Dashboard</li>
        <li>Verify balance shows "100 coins"</li>
        <li>Click a bet button and verify balance decreases</li>
        <li>Navigate to Timer tab and start a session</li>
        <li>Navigate to History tab and verify data displays</li>
        <li>Refresh page and verify all data persists</li>
    </ol>

    <h2>Quick Links</h2>
    <ul>
        <li><a href="index.html" style="color: #4c9aff;">Launch AuraFlow Application ‚Üí</a></li>
        <li><a href="AUDIT_SUMMARY.md" style="color: #4c9aff;">View Audit Summary ‚Üí</a></li>
        <li><a href="BUGFIXES.md" style="color: #4c9aff;">View Bug Fixes ‚Üí</a></li>
        <li><a href="TEST_RESULTS.md" style="color: #4c9aff;">View Test Results ‚Üí</a></li>
    </ul>

    <script type="module">
        async function runTests() {
            const resultsDiv = document.getElementById('results');
            const summaryDiv = document.getElementById('summary');
            resultsDiv.innerHTML = '<p>Running tests...</p>';

            const tests = [];
            let passed = 0;
            let failed = 0;

            // Test 1: Check if required files exist
            try {
                await fetch('js/main.js');
                tests.push({ name: 'Main application file exists', pass: true });
                passed++;
            } catch (e) {
                tests.push({ name: 'Main application file exists', pass: false, error: e.message });
                failed++;
            }

            // Test 2: Check if sql.js exists
            try {
                await fetch('lib/sql-wasm.js');
                tests.push({ name: 'SQL.js library exists', pass: true });
                passed++;
            } catch (e) {
                tests.push({ name: 'SQL.js library exists', pass: false, error: e.message });
                failed++;
            }

            // Test 3: Check if initial events data exists
            try {
                const response = await fetch('js/data/initial-events.json');
                const data = await response.json();
                if (data.length === 18) {
                    tests.push({ name: '18 initial events present', pass: true });
                    passed++;
                } else {
                    tests.push({ name: '18 initial events present', pass: false, error: `Found ${data.length} events` });
                    failed++;
                }
            } catch (e) {
                tests.push({ name: '18 initial events present', pass: false, error: e.message });
                failed++;
            }

            // Test 4: Check if CSS files exist
            try {
                await fetch('styles/variables.css');
                await fetch('styles/layout.css');
                await fetch('styles/components.css');
                tests.push({ name: 'CSS files exist', pass: true });
                passed++;
            } catch (e) {
                tests.push({ name: 'CSS files exist', pass: false, error: e.message });
                failed++;
            }

            // Test 5: Check if core modules exist
            try {
                await fetch('js/core/database.js');
                await fetch('js/core/storage.js');
                await fetch('js/core/eventbus.js');
                await fetch('js/core/state.js');
                tests.push({ name: 'Core modules exist', pass: true });
                passed++;
            } catch (e) {
                tests.push({ name: 'Core modules exist', pass: false, error: e.message });
                failed++;
            }

            // Test 6: Check if service files exist
            try {
                await fetch('js/services/BalanceService.js');
                await fetch('js/services/TimerService.js');
                await fetch('js/services/BettingService.js');
                await fetch('js/services/HistoryService.js');
                tests.push({ name: 'Service modules exist', pass: true });
                passed++;
            } catch (e) {
                tests.push({ name: 'Service modules exist', pass: false, error: e.message });
                failed++;
            }

            // Test 7: Check if component files exist
            try {
                await fetch('js/components/Dashboard.js');
                await fetch('js/components/PomodoroTimer.js');
                await fetch('js/components/History.js');
                tests.push({ name: 'Component modules exist', pass: true });
                passed++;
            } catch (e) {
                tests.push({ name: 'Component modules exist', pass: false, error: e.message });
                failed++;
            }

            // Display results
            summaryDiv.innerHTML = `
                <h3>Summary</h3>
                <p><strong>Total Tests:</strong> ${tests.length}</p>
                <p><strong style="color: #00c853;">Passed:</strong> ${passed}</p>
                <p><strong style="color: #ff3366;">Failed:</strong> ${failed}</p>
                <p><strong>Success Rate:</strong> ${((passed / tests.length) * 100).toFixed(0)}%</p>
            `;

            resultsDiv.innerHTML = tests.map(test => `
                <div class="test ${test.pass ? 'pass' : 'fail'}">
                    <div class="status">${test.pass ? '‚úÖ PASS' : '‚ùå FAIL'}</div>
                    <div><strong>${test.name}</strong></div>
                    ${test.error ? `<div style="color: #ff3366; margin-top: 5px;">Error: ${test.error}</div>` : ''}
                </div>
            `).join('');

            if (failed === 0) {
                resultsDiv.innerHTML += `
                    <div class="test pass">
                        <div class="status">üéâ All validation tests passed!</div>
                        <div>The application structure is correct. Open <a href="index.html" style="color: #4c9aff;">index.html</a> to test full functionality.</div>
                    </div>
                `;
            }
        }

        window.runTests = runTests;
    </script>
</body>
</html>
